function confineToIframe(){if(!1===inIframe()){var e=document.createElement("div");e.id="bgDiv",e.className="bgDiv",document.body.appendChild(e),alert("Improper Access: This form should not be accessed in this way, please file an Issue.")}}function inIframe(){try{return window.self!==window.top}catch(e){return!0}}function openOverlay(e,t="No title provided."){var a=document.createElement("a");a.href=e,rid=a.pathname.substring(a.pathname.lastIndexOf("/")+1).replace(".cfm","");var n=document.createElement("div");n.id="overlayDiv"+rid,n.className="overlayDiv",document.body.appendChild(n);var o=document.createElement("div");o.className="overlayDivHeader",o.id="overlayDivHeader",o.append(t),$("#overlayDiv"+rid).append(o);var l=document.createElement("span");l.className="closeOverlay",l.id="closeOverlay",l.setAttribute("onclick","closeOverlay('"+rid+"')"),l.append("\xd7"),$("#overlayDivHeader").append(l),$("#overlayDiv"+rid).append('<img id="overlayLoadingImg" src="/images/loadingAnimation.gif" class="centeredImage">');var r=document.createElement("iFrame");r.id="overlayiFrame",r.className="overlayiFrame",r.src=e,$("#overlayDiv"+rid).append(r),$("#overlayLoadingImg").remove()}function closeOverlay(e){$("#overlayDiv"+e).remove(),$("#overlayDiv"+e,window.parent.document).remove()}function toggleInfo(e){document.querySelector("#"+e).classList.toggle("noshow"),document.querySelector("#"+e+"_show").classList.toggle("noshow"),document.querySelector("#"+e+"_hide").classList.toggle("noshow")}function pickEscapeSingleQuoteOnly(e){return e.replace(/'/g,"\\'")}function pickEscapeQuote(e){var t;if(e)return(t=e.replace(/'/g,"\\'")).replace(/"/g,"`")}function convertCoords(e,t){$("<iframe src='/form/coordinateConverter.cfm?dlatfld="+e+"&dlonfld="+t+"' id='dialog' class='popupDialog' style='width:600px;height:600px;'></iframe>").dialog({autoOpen:!0,closeOnEscape:!0,height:"auto",modal:!0,position:["center","top"],title:"Coordinate Converter",width:800,height:600,close:function(){$(this).remove()}}).width(790).height(590),$(window).resize(function(){$(".ui-dialog-content").dialog("option","position",["center","center"])}),$(".ui-widget-overlay").click(function(){$(".ui-dialog-titlebar-close").trigger("click")})}function pickTaxonConcept(e,t,a){var n;a=encodeURIComponent(a),$("#"+t).addClass("badPick"),$("<iframe src='"+("/picks/findTaxonConcept.cfm?tcidFld="+e+"&tcvFld="+t+"&name=")+(n=void 0!==a?a:"")+"' id='dialog' class='popupDialog' style='width:600px;height:600px;'></iframe>").dialog({autoOpen:!0,closeOnEscape:!0,height:"auto",modal:!0,position:["center","top"],title:"Pick Concept",width:800,height:600,close:function(){$(this).remove()}}).width(790).height(590),$(window).resize(function(){$(".ui-dialog-content").dialog("option","position",["center","center"])}),$(".ui-widget-overlay").click(function(){$(".ui-dialog-titlebar-close").trigger("click")})}function postSessTime(e){try{if(!$("#sessExpMin").length||!$("#slcd").length)return!1;void 0!==e&&$("#slcd").val(e);var t,a=(new Date).getTime(),n=$("#slcd").val(),o=Math.round((54e5-(a-n))/6e4);o<=5&&(t="expSoon"),o<=0&&(o="NOW!",$("#signoutbuttonitem").html("<a href=\"#\" onclick=\"openOverlay('/form/loginformguts.cfm','Log in, log out, create account, or recover password.');\">Sign In</a>")),$("#sessExpMinNO").html(" ["+o+"]"),$("#sessExpMin").html(o+" minutes left in session")}catch(l){}}function createAgent(e,t,a,n,o){if(!t)var t="";if(!a)var a="";if(!n)var n="";if(!o)var o="";var l="/includes/forms/createagent.cfm?agent_type="+e+"&caller="+t+"&agentIdFld="+a+"&agentNameFld="+n+"&agentNameVal="+o;parent.$("#dialog").length?parent.$("#dialog").attr("src",l):($("<iframe src='"+l+"' id='dialog' class='popupDialog' style='width:1200px;height:800px;'></iframe>").dialog({autoOpen:!0,closeOnEscape:!0,height:"auto",modal:!0,position:["center","center"],title:"New Agent",width:1200,height:800,close:function(){$(this).remove()}}).width(1190).height(790),$(window).resize(function(){$(".ui-dialog-content").dialog("option","position",["center","center"])}),$(".ui-widget-overlay").click(function(){$(".ui-dialog-titlebar-close").trigger("click")}))}function pickAgentModal(e,t,a){var n;a=encodeURIComponent(a),$("#"+t).addClass("badPick"),$("<iframe src='"+("/picks/findAgentModal.cfm?agentIdFld="+e+"&agentNameFld="+t+"&agent_name=")+(n=void 0!==a?a:"")+"' id='dialog' class='popupDialog' style='width:1200px;height:600px;'></iframe>").dialog({autoOpen:!0,closeOnEscape:!0,height:"auto",modal:!0,position:["center","top"],title:"Pick Agent",width:1200,height:600,close:function(){$(this).remove()}}).width(1190).height(590),$(window).resize(function(){$(".ui-dialog-content").dialog("option","position",["center","center"])}),$(".ui-widget-overlay").click(function(){$(".ui-dialog-titlebar-close").trigger("click")})}function getFormattedDate(){var e=new Date;return e.getFullYear()+"-"+getFormattedPartTime(e.getMonth()+1)+"-"+getFormattedPartTime(e.getDate())}function getFormattedPartTime(e){return e<10?"0"+e:e}function fetchMediaMeta(){var e=[];$("[data-doi]").each(function(t,a){var n=$(this).attr("data-doi");e.push(n)});var t=e.join();0!=t.length&&$.ajax({url:"/component/functions.cfc?queryformat=column",type:"GET",dataType:"json",data:{method:"getPubCitSts",doilist:t,returnformat:"json"},success:function(e){"SUCCESS"==e.STATUS?$.each(e.STSARY,function(e,t){var a="<ul>";a+="<li>References Count: "+t.REFERENCE_COUNT+"</li>",a+="<li>Referenced By Count: "+t.REFERENCE_BY_COUNT+"</li>",a+='<li><a data-doi="'+t.DOI+'" href="/info/publicationDetails.cfm?doi='+t.DOI+'" class="modalink">CrossRef Data</a></li>',a+="</ul>",$("#x"+t.DOI.replace(/[\W_]+/g,"_")).append(a)}):alert(e.STATUS+": "+e.MSG)},error:function(e,t,a){alert(a+": "+t+": "+e)}})}function showPubInfo(e){$("<iframe src='/info/publicationDetails.cfm?doi="+e+"' id='dialog' class='popupDialog' style='width:800px;height:800px;'></iframe>").dialog({autoOpen:!0,closeOnEscape:!0,height:"auto",modal:!0,position:["center","center"],title:"Publication Details",width:800,height:800,close:function(){$(this).remove()}}).width(790).height(790),$(window).resize(function(){$(".ui-dialog-content").dialog("option","position",["center","center"])}),$(".ui-widget-overlay").click(function(){$(".ui-dialog-titlebar-close").trigger("click")})}function addMedia(e,t){$("<iframe src='/picks/upLinkMedia.cfm?ktype="+e+"&kval="+t+"' id='dialog' class='popupDialog' style='width:600px;height:600px;'></iframe>").dialog({autoOpen:!0,closeOnEscape:!0,height:"auto",modal:!0,position:["center","center"],title:"Add Media",width:800,height:600,close:function(){$(this).remove()}}).width(790).height(590),$(window).resize(function(){$(".ui-dialog-content").dialog("option","position",["center","center"])}),$(".ui-widget-overlay").click(function(){$(".ui-dialog-titlebar-close").trigger("click")})}function rankAgent(e){$("<div id='dialog' class='popupDialog'><img src='/images/indicator.gif'></div>").dialog({autoOpen:!0,closeOnEscape:!0,height:"auto",modal:!0,position:["center","center"],title:"Rank Agent",width:"auto",close:function(){$(this).remove()}}).load("/includes/forms/agentrank.cfm?agent_id="+e,function(){$(this).dialog("option","position",["center","center"])}),$(window).resize(function(){$(".ui-dialog-content").dialog("option","position",["center","center"])}),$(".ui-widget-overlay").click(function(){$(".ui-dialog-titlebar-close").trigger("click")})}function checkReplaceNoPrint(e,t){var a;if(0!==$("#"+t).val().length){if($("#"+t).val().indexOf("[NOPRINT]")>=0)return alert("remove [NOPRINT] from "+t),e.preventDefault(),!1;$.ajax({url:"/component/functions.cfc?queryformat=column",type:"POST",dataType:"json",async:!1,data:{method:"removeNonprinting",orig:$("#"+t).val(),userString:"[NOPRINT]",returnformat:"json"},success:function(n){if(n.DATA.REPLACED_WITH_USERSTRING[0]!=$("#"+t).val())return $("#"+t).val(n.DATA.REPLACED_WITH_USERSTRING[0]),a="The form cannot be submitted: There are nonprinting characters in "+t+".\n\n",a+="Nonprinting characters have been replaced with [NOPRINT]. Remove that to continue.\n\n",alert(a+="You may use HTML markup for print control: <br> is linebreak"),e.preventDefault(),!1},error:function(t,a,n){return alert(n+": "+a+": "+t),e.preventDefault(),!1}})}}function setSessionCustomID(e){$.getJSON("/component/functions.cfc",{method:"setSessionCustomID",val:e,returnformat:"json",queryformat:"column"},function(e){})}function checkCSV(e){var t,a;"csv"!=(a=(t=e.value).substring(t.lastIndexOf(".")+1).toLowerCase())?(alert("Only files with the file extension CSV are allowed"),$("input[type=submit]").hide()):$("input[type=submit]").show()}function getMedia(e,t,a,n,o){var l;$("#"+a).find($("#imgBrowserCtlDiv")).append('<img src="/images/indicator.gif">'),l="/form/inclMedia.cfm?typ="+e+"&q="+t+"&tgt="+a+"&rpp="+n+"&pg="+o,$.get(l,function(e){$("#"+a).html(e)})}function findPart(e,t,a){var n,o;o=(n="/picks/findPart.cfm")+"?part_name="+(t=t.replace("%","_"))+"&guid_prefix="+a+"&partFld="+e,partpick=window.open(o,"","width=800,height=600, resizable,scrollbars")}function isValidEmailAddress(e){var t;return(t=RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i)).test(e)}function saveThisAnnotation(){var e,t,a,n,o;return(e=document.getElementById("idtype").value,t=document.getElementById("idvalue").value,a=document.getElementById("annotation").value,n=$("#captchaHash").val(),o=$("#captcha").val().toUpperCase(),a.length<=20)?(alert("You must enter an annotation of at least 20 characters to save."),!1):isValidEmailAddress($("#email").val())?void($("#annotateDiv").append('<div id="svgol" style="float:left;position:absolute;top:0;width:100%;height:100%;background-color:rgba(128,128,128,0.5);padding-left:50%;padding-top:20%;"><img src="/images/indicator.gif"></div>'),$.ajax({url:"/component/functions.cfc",type:"POST",dataType:"json",data:{method:"hashString",string:o,returnformat:"json"},success:function(n){$.ajax({url:"/component/functions.cfc",type:"POST",dataType:"json",data:{method:"addAnnotation",idType:e,idvalue:t,annotation:a,email:$("#email").val(),returnformat:"json",queryformat:"column"},success:function(e){return"success"==e?($("#svgol").remove(),alert("Your annotations have been saved, and the appropriate curator will be alerted. \n Thank you for helping improve Arctos!"),closeOverlay("annotate")):($("#svgol").remove(),alert("An error occured! \n "+e)),!0},error:function(e,t,a){console.log(a+": "+t+": "+e)}})},error:function(e,t,a){console.log(a+": "+t+": "+e)}})):(alert("Enter a valid email address."),!1)}function openAnnotation(e){$("<iframe src='/info/annotate.cfm?q="+e+"' id='dialog' class='popupDialog' style='width:600px;height:600px;'></iframe>").prop("id","dialog").dialog({autoOpen:!0,closeOnEscape:!0,height:"auto",modal:!0,position:["center","center"],title:"Report Bad Data",width:800,height:600,close:function(){$(this).remove()}}).width(790).height(590),$(window).resize(function(){$(".ui-dialog-content").dialog("option","position",["center","center"])}),$(".ui-widget-overlay").click(function(){$(".ui-dialog-titlebar-close").trigger("click")})}function closeAnnotation(){parent.$(".ui-dialog-titlebar-close").trigger("click")}function lockArchive(e){if(!0!==confirm("Are you sure you want to lock this Archive?"))return!1;jQuery.getJSON("/component/functions.cfc",{method:"lockArchive",archive_name:e,returnformat:"json",queryformat:"column"},function(e){alert(e)})}function saveSearch(e,t){var a,n,o,l,r;a=Date.now(),void 0!==t&&t.length>0&&(r="ERROR: "+t+"\n\n"),r="Saving search for URL:\n\n"+e+" \n\nName your saved search (or copy and ",r+="paste the link above).\n\nManage or email saved searches from your profile, or go to /saved/{name of saved search}. Note ",r+="that saved searches, except those sepecifying only GUIDs, are dynamic; results change as data changes.\n\nName of saved search (must be unique):\n",null!==(n=prompt(r,a))&&(o=encodeURIComponent(n),l=e,$.getJSON("/component/functions.cfc",{method:"saveSearch",returnURL:l,srchName:o,returnformat:"json",queryformat:"column"},function(t){if("success"!=t){if(alert(t),"You must create an account or log in to save searches."==t)return!1;saveSearch(e,t)}else alert("Saved search \n"+(url=(protocol=(pathArray=window.location.href.split("/"))[0])+"//"+(host=pathArray[2]))+"/saved/"+o+"\n Find it in your username tab.")}))}function changecustomOtherIdentifier(e){$.getJSON("/component/functions.cfc",{method:"changecustomOtherIdentifier",tgt:e,returnformat:"json",queryformat:"column"},function(e){"success"==e?document.getElementById("customOtherIdentifier").className="":alert("An error occured: "+e)})}function IsNumeric(e){var t,a=!0;for(i=0;i<e.length&&!0===a;i++)t=e.charAt(i),-1=="0123456789.".indexOf(t)&&(a=!1);return a}function orapwCheck(e,t){var a=/^[A-Za-z0-9!$%&_?(\-)<>=/:;*\.]$/,n="Password is acceptable";e.indexOf(t)>-1&&(n="Password may not contain your username."),(e.length<6||e.length>30)&&(n="Password must be between 6 and 30 characters."),e.match(/[a-zA-Z]/)||(n="Password must contain at least one letter."),e.match(/\d+/)||(n="Password must contain at least one number."),e.match(/[!,$,%,&,*,?,_,-,(,),<,>,=,/,:,;,.]/)||(n="Password must contain at least one of: !,$,%,&,*,?,_,-,(,),<,>,=,/,:,;.");for(var o=0;o<e.length;o++)e.charAt(o).match(a)||(n="Password may contain only A-Z, a-z, 0-9, and !$%&_?(-)<>=/:;*.");return n}function getCtDocVal(e,t){var a="/info/ctDocumentation.cfm?table="+e;if(t)var n=$("#"+t).val();else var n="";n.length>0&&(a+="#"+n.replace(/[^0-9a-zA-Z]/g,"_").toLowerCase()),windowOpener(a,"ctDocWin","width=700,height=400, resizable,scrollbars")}function getCtDoc(e,t){var a="/info/ctDocumentation.cfm?table="+e;void 0!==t&&(a+="#"+t.replace(/[^0-9a-zA-Z]/g,"_").toLowerCase()),windowOpener(a,"ctDocWin","width=700,height=400, resizable,scrollbars")}function windowOpener(e,t,a){"object"!=typeof(popupWins=[])[t]?popupWins[t]=window.open(e,t,a):popupWins[t].closed?popupWins[t]=window.open(e,t,a):popupWins[t].location.href=e,popupWins[t].focus()}function noenter(e){var t;return 13!=(t=window.event?window.event.keyCode:e.which)}function getLoan(e,t,a,n){var o,l;l=(o="/picks/getLoan.cfm")+"?LoanIDFld="+e+"&LoanNumberFld="+t+"&loanNumber="+a+"&agent_name="+n,loanpickwin=window.open(l,"","width=400,height=338, resizable,scrollbars")}function pickSpecEvtLnk(e,t,a){$("<iframe src='"+("/picks/linkSpecimenEvent.cfm?collection_object_id="+e+"&rel_key_typ="+t)+"&rel_key_val="+a+"' id='dialog' class='popupDialog' style='width:600px;height:600px;'></iframe>").dialog({autoOpen:!0,closeOnEscape:!0,height:"auto",modal:!0,position:["center","top"],title:"Pick Linked Event",width:800,height:600,close:function(){$(this).remove()}}).width(790).height(590),$(window).resize(function(){$(".ui-dialog-content").dialog("option","position",["center","center"])}),$(".ui-widget-overlay").click(function(){$(".ui-dialog-titlebar-close").trigger("click")})}function getPublication(e,t,a){var n=encodeURIComponent(a);n=n.replace(/[!'()*]/g,escape),$("#"+e).addClass("badPick");var o="/picks/findPublication.cfm?pubStringFld="+e+"&publication_title="+n;$("<iframe src='"+(o+="&pubIdFld="+t)+"' id='dialog' class='popupDialog' style='width:600px;height:600px;'></iframe>").dialog({autoOpen:!0,closeOnEscape:!0,height:"auto",modal:!0,position:["center","center"],title:"Find Publication",width:800,height:600,close:function(){$(this).remove()}}).width(790).height(590),$(window).resize(function(){$(".ui-dialog-content").dialog("option","position",["center","center"])}),$(".ui-widget-overlay").click(function(){$(".ui-dialog-titlebar-close").trigger("click")})}function getProject(e,t,a,n){var o,l;l=(o="/picks/findProject.cfm")+"?projIdFld="+e+"&projNameFld="+t+"&formName="+a+"&project_name="+n,projpickwin=window.open(l,"","width=400,height=338, resizable,scrollbars")}function findCatalogedItem(e,t,a,n,o,l){var r,d;d=(r="/picks/findCatalogedItem.cfm")+"?collIdFld="+e+"&CatNumStrFld="+t+"&formName="+a+"&oidType="+n+"&oidNum="+o+"&collID="+l,catItemWin=window.open(d,"","width=400,height=338, resizable,scrollbars")}function pickCollectingEvent(e,t,a){$("#"+t).addClass("badPick"),$("<iframe src='"+("/place.cfm?sch=collecting_event&specop=pick_collecting_event&dispfld="+t+"&idfld="+e)+"&collecting_event_name="+a+"' id='dialog' class='popupDialog' style='width:1200px;height:800px;'></iframe>").dialog({autoOpen:!0,closeOnEscape:!0,height:"auto",modal:!0,position:{my:"top",at:"top+150"},title:"Pick Event",width:1200,height:800,close:function(){$(this).remove()}}).width(1190).height(790),$(window).resize(function(){$(".ui-dialog-content").dialog("option","position",["center","center"])}),$(".ui-widget-overlay").click(function(){$(".ui-dialog-titlebar-close").trigger("click")})}function pickLocality(e,t,a){$("#"+t).addClass("badPick"),$("<iframe src='"+("/place.cfm?sch=locality&specop=pick_locality&dispfld="+t+"&idfld="+e)+"&locality_name="+a+"' id='dialog' class='popupDialog' style='width:1200px;height:800px;'></iframe>").dialog({autoOpen:!0,closeOnEscape:!0,height:"auto",modal:!0,position:{my:"top",at:"top+150"},title:"Pick Locality",width:1200,height:800,close:function(){$(this).remove()}}).width(1190).height(790),$(window).resize(function(){$(".ui-dialog-content").dialog("option","position",["center","center"])}),$(".ui-widget-overlay").click(function(){$(".ui-dialog-titlebar-close").trigger("click")})}function pickGeography(e,t,a){$("#"+t).addClass("badPick"),$("<iframe src='"+("/place.cfm?sch=geog&specop=pick_geog&dispfld="+t+"&idfld="+e)+"&any_geog="+a+"' id='dialog' class='popupDialog' style='width:1200px;height:800px;'></iframe>").dialog({autoOpen:!0,closeOnEscape:!0,height:"auto",modal:!0,position:{my:"top",at:"top+150"},title:"Pick Geography",width:1200,height:800,close:function(){$(this).remove()}}).width(1190).height(790),$(window).resize(function(){$(".ui-dialog-content").dialog("option","position",["center","center"])}),$(".ui-widget-overlay").click(function(){$(".ui-dialog-titlebar-close").trigger("click")})}function getAccn(e,t,a){var n="/picks/findAccn.cfm?r_accnNumber="+e+"&rtnFldID="+t+"&r_InstAcrColnCde="+a;n=window.open(n,"","width=400,height=338, resizable,scrollbars")}function getAccnMedia(e,t){var a,n;n=(a="/picks/getAccnMedia.cfm")+"?idOfTxtFld="+e+"&idOfPKeyFld="+t,n=window.open(n,"","width=400,height=338, resizable,scrollbars")}function getAccn2(e,t){var a,n;n=(a="/picks/getAccn.cfm")+"?accnNumber="+e+"&collectionID="+t,n=window.open(n,"","width=400,height=338, resizable,scrollbars")}function getGeog(e,t,a,n){var o,l;l=(o="/picks/GeogPick2.cfm")+"?geogIdFld="+e+"&highGeogFld="+t+"&formName="+a+"&srchstring="+n,geogpick=window.open(l,"","width=600,height=600, toolbar,resizable,scrollbars,")}function confirmDelete(e,t){var a;if(!0!==(a=confirm("Are you sure you want to delete "+(t=t||"this record")+"?")))return!1;document[e].submit()}function findMedia(e,t,a){var n,o;o=(n="/picks/findMedia.cfm")+"?mediaIdFld="+t+"&mediaStringFld="+e+"&media_uri="+a,mediapick=window.open(o,"","width=400,height=338, resizable,scrollbars")}function taxaPick(e,t,a,n){var o,l;l=(o="/picks/TaxaPick.cfm")+"?taxonIdFld="+e+"&taxonNameFld="+t+"&formName="+a+"&scientific_name="+n,taxapick=window.open(l,"","width=1200,height=800, resizable,scrollbars")}function deleteEncumbrance(e,t){var a,n,o;n=(a="/picks/DeleteEncumbrance.cfm")+"?encumbrance_id="+e+"&collection_object_id="+t,o=window.open(n,"","width=400,height=338, toolbar,location,status,menubar,resizable,scrollbars,")}function toProperCase(e){var t=document.getElementById(e);t.value.length;var a=t.selectionStart,n=t.selectionEnd,o=t.value.substring(a,n).toLowerCase().replace(/^(.)|\s(.)/g,function(e){return e.toUpperCase()}),l=t.value.substring(0,a),r=t.value.substring(n,t.value.length);t.value=l+o+r}function italicize(e){var t=document.getElementById(e),a=t.value.length,n=t.selectionStart,o=t.selectionEnd,l=t.value.substring(n,o);l.length>0&&(t.value=t.value.substring(0,n)+"<i>"+l+"</i>"+t.value.substring(o,a))}function bold(e){var t=document.getElementById(e),a=t.value.length,n=t.selectionStart,o=t.selectionEnd,l=t.value.substring(n,o);l.length>0&&(t.value=t.value.substring(0,n)+"<b>"+l+"</b>"+t.value.substring(o,a))}function superscript(e){var t=document.getElementById(e),a=t.value.length,n=t.selectionStart,o=t.selectionEnd,l=t.value.substring(n,o);l.length>0&&(t.value=t.value.substring(0,n)+"<sup>"+l+"</sup>"+t.value.substring(o,a))}function subscript(e){var t=document.getElementById(e),a=t.value.length,n=t.selectionStart,o=t.selectionEnd,l=t.value.substring(n,o);l.length>0&&(t.value=t.value.substring(0,n)+"<sub>"+l+"</sub>"+t.value.substring(o,a))}function removeUpload(){document.getElementById("uploadDiv")&&$("#uploadDiv").remove(),removeBgDiv()}function closeUpload(e,t){document.getElementById("media_uri").value=e,document.getElementById("preview_uri").value=t;var a=e.split(".").pop();"jpg"==a||"jpeg"==a?($("#mime_type").val("image/jpeg"),$("#media_type").val("image")):"pdf"==a?($("#mime_type").val("application/pdf"),$("#media_type").val("text")):"mp3"==a?($("#mime_type").val("audio/mpeg3"),$("#media_type").val("audio")):"wav"==a?($("#mime_type").val("audio/x-wav"),$("#media_type").val("audio")):"dng"==a?($("#mime_type").val("image/dng"),$("#media_type").val("image")):"png"==a?($("#mime_type").val("image/png"),$("#media_type").val("image")):"tif"==a||"tiff"==a?($("#mime_type").val("image/tiff"),$("#media_type").val("image")):"htm"==a||"html"==a?($("#mime_type").val("text/html"),$("#media_type").val("")):"txt"==a?($("#mime_type").val("text/plain"),$("#media_type").val("text")):"mp4"==a&&($("#mime_type").val("video/mp4"),$("#media_type").val("video")),removeUpload()}function generateMD5(){var e;$.getJSON("/component/functions.cfc",{method:"genMD5",uri:$("#media_uri").val(),returnformat:"json",queryformat:"column"},function(t){addLabel(e=parseInt($("#number_of_labels").val())+parseInt(1)),$("#label__"+e).val("MD5 checksum"),$("#label_value__"+e).val(t)})}function closePreviewUpload(e){var t=document.getElementById("uploadDiv");document.body.removeChild(t),document.getElementById("preview_uri").value=e}function pickedRelationship(e){var t=document.getElementById(e).value,a=e.lastIndexOf("__"),n=e.substring(a+2,e.length),o=t.split(" "),l=o[o.length-1],r="related_id__"+n,d="related_value__"+n;document.getElementById(r).value="",document.getElementById(d).value="",""===l||("agent"==l?pickAgentModal(r,d,""):"locality"==l?LocalityPick(r,d,"newMedia"):"collecting_event"==l?pickCollectingEvent(r,d,""):"cataloged_item"==l?findCatalogedItem(r,d,"newMedia"):"project"==l?getProject(r,d,"newMedia"):"taxon_name"==l?taxaPick(r,d,"newMedia"):"publication"==l?getPublication(d,r,""):"accn"==l?getAccnMedia(d,r):"media"==l?findMedia(d,r):"loan"==l?getLoan(r,d):"permit"==l?alert("Edit permit to add Media"):"delete"==l?document.getElementById(d).value="Marked for deletion.....":alert("Something is broken. I have no idea what to do with a relationship to "+l))}function addRelation(e){var t,a,n,o,l,r,d,s,u,g,p,m,h;t=document.getElementById("relationships"),(a=document.createElement("div")).id="relationshipDiv__"+e,t.appendChild(a),o="relationship__"+(n=e-1),(l=document.getElementById(o).cloneNode(!0)).name="relationship__"+e,l.id="relationship__"+e,l.value="delete",a.appendChild(l),(c=document.createElement("textNode")).innerHTML=":&nbsp;",a.appendChild(c),r="related_value__"+(n=e-1),(d=document.getElementById(r).cloneNode(!0)).name="related_value__"+e,d.id="related_value__"+e,d.value="",a.appendChild(d),s="related_id__"+n,(u=document.getElementById(s).cloneNode(!0)).name="related_id__"+e,u.id="related_id__"+e,a.appendChild(u),g=document.getElementById("addRelationship"),t.removeChild(g),m="addRelation("+(p=e+1)+")",g.setAttribute("onclick",m),t.appendChild(g),(h=document.getElementById("number_of_relations")).value=parseInt(h.value)+1}function addLabel(e){var t,a,n,o,l,r,d,s,u,g,p;t=document.getElementById("labels"),(a=document.createElement("div")).id="labelsDiv__"+e,t.appendChild(a),o="label__"+(n=e-1),(l=document.getElementById(o).cloneNode(!0)).name="label__"+e,l.id="label__"+e,l.value="",a.appendChild(l),(c=document.createElement("textNode")).innerHTML=":&nbsp;",a.appendChild(c),r="label_value__"+n,(d=document.getElementById(r).cloneNode(!0)).name="label_value__"+e,d.id="label_value__"+e,d.value="",a.appendChild(d),s=document.getElementById("addLabel"),t.removeChild(s),g="addLabel("+(u=e+1)+")",s.setAttribute("onclick",g),t.appendChild(s),(p=document.getElementById("number_of_labels")).value=parseInt(p.value)+1}function saveAgentRank(){$.getJSON("/component/functions.cfc",{method:"saveAgentRank",agent_id:$("#agent_id").val(),agent_rank:$("#agent_rank").val(),remark:$("#remark").val(),transaction_type:$("#transaction_type").val(),returnformat:"json",queryformat:"column"},function(e){if(e.length>0&&"fail"==e.substring(0,4))alert(e);else{var t='<tr id="tablr'+e+'"><td>'+$("#agent_rank").val()+"</td>";t+="<td>"+$("#transaction_type").val()+"</td>",t+="<td>- just now - </td>",t+='<td>- you - <span class="infoLink" onclick="revokeAgentRank(\''+e+"');\">revoke</span></td>",t+="<td>"+$("#remark").val()+"</td></tr>",$("#agntRankTbl").append(t)}})}function revokeAgentRank(e){$.getJSON("/component/functions.cfc",{method:"revokeAgentRank",agent_rank_id:e,returnformat:"json",queryformat:"column"},function(t){t.length>0&&"fail"==t.substring(0,4)?alert(t):$("#tablr"+e).remove()})}function removeMediaMultiCatItem(){$("#bgDiv").remove(),$("#pickFrame").remove()}function manyCatItemToMedia(e){var t=document.createElement("div");t.id="bgDiv",t.className="bgDiv",t.setAttribute("onclick","removeMediaMultiCatItem()"),document.body.appendChild(t),$('<iframe id="pickFrame" name="pickFrame" class="pickDiv" src="/includes/forms/manyCatItemToMedia.cfm?media_id='+e+'">').appendTo("body")}function removePick(){document.getElementById("pickDiv")&&$("#pickDiv").remove(),removeBgDiv()}function addBGDiv(e){var t=document.createElement("div");t.id="bgDiv",t.className="bgDiv",(null===e||0===e.length)&&(e="removeBgDiv()"),t.setAttribute("onclick",e),document.body.appendChild(t)}function removeBgDiv(){document.getElementById("bgDiv")&&$("#bgDiv").remove()}function deleteAgent(e){$("#author_name"+e).addClass("red").val("deleted"),$("#authortr"+e+" td:nth-child(1)").addClass("red"),$("#authortr"+e+" td:nth-child(3)").addClass("red")}$.datepicker.setDefaults({dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0,constrainInput:!1,yearRange:"c-200:c+10"}),$(document).ready(function(){if("BroadcastChannel"in self)try{let e=new BroadcastChannel("session_time");var t=(new Date).getTime();e.postMessage(t),e.onmessage=function(e){postSessTime(e.data)},postSessTime(t)}catch(a){}$(".expandoSelect").on("click",function(){var e=$(this).data("ctl");if($("#"+e).prop("multiple"))$("#"+e).removeAttr("multiple").attr("size","1");else{var t=Math.min($("#"+e+" option").length,10);$("#"+e).attr("multiple","multiple").attr("size",t)}}),$(document).on("click","a[class=newWinLocal]",function(){this.target="_blank"}),$(document).on("click","a[class=external]",function(){this.target="_blank"}),$(document).on("click","a[class=handbook]",function(){this.target="_blank"}),$(document).on("click","a[class=newwin]",function(){this.target="_blank"}),$(document).on("click",".helpLink",function(e){var t=$(this).data("helplink");if(null==t)var t=this.id;$("<iframe src='/doc/get_short_doc.cfm?fld="+t+"' id='dialog' class='popupDialog' style='width:800px;height:600px;'></iframe>").dialog({autoOpen:!0,closeOnEscape:!0,height:"auto",modal:!0,position:{my:"top",at:"top+150"},title:"Documentation",width:800,height:600,close:function(){$(this).remove()}}).width(790).height(590),$(window).resize(function(){$(".ui-dialog-content").dialog("option","position",["center","center"])}),$(".ui-widget-overlay").click(function(){$(".ui-dialog-titlebar-close").trigger("click")})}),window.self!==window.top&&($("#the_whole_header").hide(),$("#arctosfooter").hide()),$("input[type='date'], input[type='datetime']").datepicker(),window.setInterval(function(){postSessTime()},6e4)});